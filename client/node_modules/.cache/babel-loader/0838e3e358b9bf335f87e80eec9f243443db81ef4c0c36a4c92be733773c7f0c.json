{"ast":null,"code":"var _jsxFileName = \"/Users/sebastiancevallos/Desktop/School/UCLA/Winter 2023/CS 35L/cs35l_project/client/src/pages/CalendarAPI2.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst config = {\n  \"clientId\": \"832026479166-3i3nl2i2nngrpjer3rjoi85a18v4ufc0.apps.googleusercontent.com\",\n  \"apiKey\": \"AIzaSyD-rsdUh4BKKlvbkYvjJRJSVV1T-KiBXQE\",\n  \"scope\": \"https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events https://www.googleapis.com/auth/calendar\",\n  // \"https://www.googleapis.com/auth/calendar\", \n  // 'https://www.googleapis.com/auth/calendar.readonly'\n  \"discoveryDocs\": [\"https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest\"]\n};\nconst GoogleCalendar = () => {\n  _s();\n  const [events, setEvents] = useState(null);\n  useEffect(() => {\n    const script = document.createElement(\"script\");\n    script.async = true;\n    script.defer = true;\n    script.src = \"https://apis.google.com/js/api.js\";\n    document.body.appendChild(script);\n    script.addEventListener(\"load\", () => {\n      if (window.gapi) handleClientLoad();\n    });\n  }, []);\n  const openSignInPopup = () => {\n    window.gapi.auth2.authorize({\n      client_id: config.clientId,\n      scope: SCOPES\n    }, res => {\n      console.log(res);\n      if (res) {\n        console.log(window.gapi.client, res);\n        if (res.access_token) localStorage.setItem(\"access_token\", res.access_token);\n\n        // fetch(\n        //   `https://www.googleapis.com/calendar/v3/users/me/calendarList?access_token=${res.access_token}`\n        // )\n        //   .then((res) => res.json())\n        //   .then((data) =>\n        //     localStorage.setItem(\"calendarId\", data.items[0].id)\n        //   );\n\n        window.gapi.client.load(\"calendar\", \"v3\", listUpcomingEvents);\n      }\n    });\n  };\n\n  /**\n   *  On load, called to load the auth2 library and API client library.\n   */\n  const handleClientLoad = () => {\n    window.gapi.load(\"client:auth2\", initClient);\n  };\n\n  /**\n   *  Initializes the API client library and sets up sign-in state\n   *  listeners.\n   */\n  const initClient = () => {\n    if (!localStorage.getItem(\"access_token\")) {\n      openSignInPopup();\n    } else {\n      fetch(`https://www.googleapis.com/calendar/v3/calendars/primary/events?key=${API_KEY}&orderBy=startTime&singleEvents=true`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`\n        }\n      }).then(res => {\n        if (res.status !== 401) {\n          return res.json();\n        } else {\n          localStorage.removeItem(\"access_token\");\n          openSignInPopup();\n        }\n      }).then(data => {\n        if (data !== null && data !== void 0 && data.items) {\n          console.log(data);\n          setEvents(formatEvents(data.items));\n        }\n      });\n    }\n  };\n\n  /**\n   * Print the summary and start datetime/date of the next ten events in\n   * the authorized user's calendar. If no events are found an\n   * appropriate message is printed.\n   */\n  const listUpcomingEvents = () => {\n    window.gapi.client.calendar.events.list({\n      calendarId: \"primary\",\n      // timeMin: new Date().toISOString(),\n      showDeleted: true,\n      singleEvents: true\n      // maxResults: 10,\n      // orderBy: \"startTime\",\n    }).then(function (response) {\n      var events = response.result.items;\n      console.log(events);\n      if (events.length > 0) {\n        setEvents(formatEvents(events));\n      }\n    });\n  };\n  const formatEvents = list => {\n    return list.map(item => ({\n      title: item.summary,\n      start: item.start.dateTime || item.start.date,\n      end: item.end.dateTime || item.end.date\n    }));\n  };\n  const addEvent = () => {\n    if (window.gapi.client || localStorage.getItem(\"access_token\")) {\n      let today = new Date();\n      fetch(`https://www.googleapis.com/calendar/v3/calendars/primary/events?key=${API_KEY}&timeMax=${new Date(\"Apr 14, 2021\").toISOString()}&timeMin=${new Date(\"Apr 15, 2021\").toISOString()}`, {\n        headers: {\n          Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`\n        }\n      }).then(res => res.json()).then(data => console.log(data));\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(React.Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"p\", {\n      children: [\" \", events, \" \"]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 151,\n    columnNumber: 5\n  }, this);\n};\n_s(GoogleCalendar, \"xl92kQS5BieEcVRXPNFPepqRmHw=\");\n_c = GoogleCalendar;\nexport default GoogleCalendar;\nvar _c;\n$RefreshReg$(_c, \"GoogleCalendar\");","map":{"version":3,"names":["React","useEffect","useState","config","GoogleCalendar","events","setEvents","script","document","createElement","async","defer","src","body","appendChild","addEventListener","window","gapi","handleClientLoad","openSignInPopup","auth2","authorize","client_id","clientId","scope","SCOPES","res","console","log","client","access_token","localStorage","setItem","load","listUpcomingEvents","initClient","getItem","fetch","API_KEY","headers","Authorization","then","status","json","removeItem","data","items","formatEvents","calendar","list","calendarId","showDeleted","singleEvents","response","result","length","map","item","title","summary","start","dateTime","date","end","addEvent","today","Date","toISOString"],"sources":["/Users/sebastiancevallos/Desktop/School/UCLA/Winter 2023/CS 35L/cs35l_project/client/src/pages/CalendarAPI2.js"],"sourcesContent":["\nimport React, { useEffect, useState } from \"react\";\n\nconst config = {\n    \"clientId\": \"832026479166-3i3nl2i2nngrpjer3rjoi85a18v4ufc0.apps.googleusercontent.com\",\n    \"apiKey\": \"AIzaSyD-rsdUh4BKKlvbkYvjJRJSVV1T-KiBXQE\",\n    \"scope\": \"https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events https://www.googleapis.com/auth/calendar\",\n    // \"https://www.googleapis.com/auth/calendar\", \n    // 'https://www.googleapis.com/auth/calendar.readonly'\n    \"discoveryDocs\": [\n      \"https://www.googleapis.com/discovery/v1/apis/calendar/v3/rest\"\n    ]\n}\n\nconst GoogleCalendar = () => {\n  const [events, setEvents] = useState(null);\n\n  useEffect(() => {\n    const script = document.createElement(\"script\");\n    script.async = true;\n    script.defer = true;\n    script.src = \"https://apis.google.com/js/api.js\";\n\n    document.body.appendChild(script);\n\n    script.addEventListener(\"load\", () => {\n      if (window.gapi) handleClientLoad();\n    });\n  }, []);\n\n  const openSignInPopup = () => {\n    window.gapi.auth2.authorize(\n      { client_id: config.clientId, scope: SCOPES },\n      (res) => {\n        console.log(res);\n        if (res) {\n          console.log(window.gapi.client, res);\n\n          if (res.access_token)\n            localStorage.setItem(\"access_token\", res.access_token);\n\n          // fetch(\n          //   `https://www.googleapis.com/calendar/v3/users/me/calendarList?access_token=${res.access_token}`\n          // )\n          //   .then((res) => res.json())\n          //   .then((data) =>\n          //     localStorage.setItem(\"calendarId\", data.items[0].id)\n          //   );\n\n          window.gapi.client.load(\"calendar\", \"v3\", listUpcomingEvents);\n        }\n      }\n    );\n  };\n\n  /**\n   *  On load, called to load the auth2 library and API client library.\n   */\n  const handleClientLoad = () => {\n    window.gapi.load(\"client:auth2\", initClient);\n  };\n\n  /**\n   *  Initializes the API client library and sets up sign-in state\n   *  listeners.\n   */\n  const initClient = () => {\n    if (!localStorage.getItem(\"access_token\")) {\n      openSignInPopup();\n    } else {\n      fetch(\n        `https://www.googleapis.com/calendar/v3/calendars/primary/events?key=${API_KEY}&orderBy=startTime&singleEvents=true`,\n        {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n          },\n        }\n      )\n        .then((res) => {\n          if (res.status !== 401) {\n            return res.json();\n          } else {\n            localStorage.removeItem(\"access_token\");\n\n            openSignInPopup();\n          }\n        })\n        .then((data) => {\n          if (data?.items) {\n            console.log(data);\n            setEvents(formatEvents(data.items));\n          }\n        });\n    }\n  };\n\n  /**\n   * Print the summary and start datetime/date of the next ten events in\n   * the authorized user's calendar. If no events are found an\n   * appropriate message is printed.\n   */\n  const listUpcomingEvents = () => {\n    window.gapi.client.calendar.events\n      .list({\n        calendarId: \"primary\",\n        // timeMin: new Date().toISOString(),\n        showDeleted: true,\n        singleEvents: true,\n        // maxResults: 10,\n        // orderBy: \"startTime\",\n      })\n      .then(function (response) {\n        var events = response.result.items;\n\n        console.log(events);\n\n        if (events.length > 0) {\n          setEvents(formatEvents(events));\n        }\n      });\n  };\n\n  const formatEvents = (list) => {\n    return list.map((item) => ({\n      title: item.summary,\n      start: item.start.dateTime || item.start.date,\n      end: item.end.dateTime || item.end.date,\n    }));\n  };\n\n  const addEvent = () => {\n    if (window.gapi.client || localStorage.getItem(\"access_token\")) {\n      let today = new Date();\n\n      fetch(\n        `https://www.googleapis.com/calendar/v3/calendars/primary/events?key=${API_KEY}&timeMax=${new Date(\n          \"Apr 14, 2021\"\n        ).toISOString()}&timeMin=${new Date(\"Apr 15, 2021\").toISOString()}`,\n        {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n          },\n        }\n      )\n        .then((res) => res.json())\n        .then((data) => console.log(data));\n    }\n  };\n\n  return (\n    <React.Fragment>\n        <p> {events} </p>\n    </React.Fragment>\n  );\n};\nexport default GoogleCalendar;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}