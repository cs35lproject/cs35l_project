{"ast":null,"code":"import _slicedToArray from \"/Users/sebastiancevallos/Desktop/School/UCLA/Winter 2023/CS 35L/cs35l_project/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _this = this,\n  _jsxFileName = \"/Users/sebastiancevallos/Desktop/School/UCLA/Winter 2023/CS 35L/cs35l_project/client/src/pages/test.js\";\nimport React, { useEffect, useState } from \"react\";\nimport FullCalendar from \"@fullcalendar/react\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\nvar CLIENT_ID = \"229181458743-7e5rj587bq9qsjr7e7c5ut4kktgunpgt.apps.googleusercontent.com\";\nvar API_KEY = \"AIzaSyAXTTATGaeYvWKHSiuLd7ucqmHeMxUoX3g\";\n\n// Authorization scopes required by the API; multiple scopes can be\n// included, separated by spaces.\nvar SCOPES = \"https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events https://www.googleapis.com/auth/calendar\";\nvar GoogleCalendar = function GoogleCalendar() {\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    events = _useState2[0],\n    setEvents = _useState2[1];\n  useEffect(function () {\n    var script = document.createElement(\"script\");\n    script.async = true;\n    script.defer = true;\n    script.src = \"https://apis.google.com/js/api.js\";\n    document.body.appendChild(script);\n    script.addEventListener(\"load\", function () {\n      if (window.gapi) handleClientLoad();\n    });\n  }, []);\n  var openSignInPopup = function openSignInPopup() {\n    window.gapi.auth2.authorize({\n      client_id: CLIENT_ID,\n      scope: SCOPES\n    }, function (res) {\n      console.log(res);\n      if (res) {\n        console.log(window.gapi.client, res);\n        if (res.access_token) localStorage.setItem(\"access_token\", res.access_token);\n\n        // fetch(\n        //   `https://www.googleapis.com/calendar/v3/users/me/calendarList?access_token=${res.access_token}`\n        // )\n        //   .then((res) => res.json())\n        //   .then((data) =>\n        //     localStorage.setItem(\"calendarId\", data.items[0].id)\n        //   );\n\n        window.gapi.client.load(\"calendar\", \"v3\", listUpcomingEvents);\n      }\n    });\n  };\n\n  /**\n   *  On load, called to load the auth2 library and API client library.\n   */\n  var handleClientLoad = function handleClientLoad() {\n    window.gapi.load(\"client:auth2\", initClient);\n  };\n\n  /**\n   *  Initializes the API client library and sets up sign-in state\n   *  listeners.\n   */\n  var initClient = function initClient() {\n    if (!localStorage.getItem(\"access_token\")) {\n      openSignInPopup();\n    } else {\n      fetch(\"https://www.googleapis.com/calendar/v3/calendars/primary/events?key=\".concat(API_KEY, \"&orderBy=startTime&singleEvents=true\"), {\n        headers: {\n          Authorization: \"Bearer \".concat(localStorage.getItem(\"access_token\"))\n        }\n      }).then(function (res) {\n        if (res.status !== 401) {\n          return res.json();\n        } else {\n          localStorage.removeItem(\"access_token\");\n          openSignInPopup();\n        }\n      }).then(function (data) {\n        if (data.items) {\n          console.log(data);\n          setEvents(formatEvents(data.items));\n        }\n      });\n    }\n  };\n\n  /**\n   * Print the summary and start datetime/date of the next ten events in\n   * the authorized user's calendar. If no events are found an\n   * appropriate message is printed.\n   */\n  var listUpcomingEvents = function listUpcomingEvents() {\n    window.gapi.client.calendar.events.list({\n      calendarId: \"primary\",\n      // timeMin: new Date().toISOString(),\n      showDeleted: true,\n      singleEvents: true\n      // maxResults: 10,\n      // orderBy: \"startTime\",\n    }).then(function (response) {\n      var events = response.result.items;\n      console.log(events);\n      if (events.length > 0) {\n        setEvents(formatEvents(events));\n      }\n    });\n  };\n  var formatEvents = function formatEvents(list) {\n    return list.map(function (item) {\n      return {\n        title: item.summary,\n        start: item.start.dateTime || item.start.date,\n        end: item.end.dateTime || item.end.date\n      };\n    });\n  };\n  var addEvent = function addEvent() {\n    if (window.gapi.client || localStorage.getItem(\"access_token\")) {\n      var today = new Date();\n      fetch(\"https://www.googleapis.com/calendar/v3/calendars/primary/events?key=\".concat(API_KEY, \"&timeMax=\").concat(new Date(\"Apr 14, 2021\").toISOString(), \"&timeMin=\").concat(new Date(\"Apr 15, 2021\").toISOString()), {\n        headers: {\n          Authorization: \"Bearer \".concat(localStorage.getItem(\"access_token\"))\n        }\n      }).then(function (res) {\n        return res.json();\n      }).then(function (data) {\n        return console.log(data);\n      });\n      //   fetch(\n      //     `https://www.googleapis.com/calendar/v3/calendars/primary/events?key=${API_KEY}`,\n      //     {\n      //       method: \"POST\",\n      //       headers: {\n      //         Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n      //       },\n      //       body: JSON.stringify({\n      //         end: {\n      //           dateTime: new Date(\"Apr 16, 2021\"),\n      //         },\n      //         start: {\n      //           dateTime: new Date(\"Apr 15, 2021\"),\n      //         },\n      //         summary: \"Test\",\n      //       }),\n      //     }\n      //   );\n    }\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: addEvent,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 7\n    }\n  }, \"Add event\"), /*#__PURE__*/React.createElement(FullCalendar, {\n    plugins: [dayGridPlugin],\n    initialView: \"dayGridMonth\",\n    events: events,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 7\n    }\n  }));\n};\nexport default GoogleCalendar;","map":{"version":3,"names":["React","useEffect","useState","FullCalendar","dayGridPlugin","CLIENT_ID","API_KEY","SCOPES","GoogleCalendar","events","setEvents","script","document","createElement","async","defer","src","body","appendChild","addEventListener","window","gapi","handleClientLoad","openSignInPopup","auth2","authorize","client_id","scope","res","console","log","client","access_token","localStorage","setItem","load","listUpcomingEvents","initClient","getItem","fetch","headers","Authorization","then","status","json","removeItem","data","items","formatEvents","calendar","list","calendarId","showDeleted","singleEvents","response","result","length","map","item","title","summary","start","dateTime","date","end","addEvent","today","Date","toISOString"],"sources":["/Users/sebastiancevallos/Desktop/School/UCLA/Winter 2023/CS 35L/cs35l_project/client/src/pages/test.js"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport FullCalendar from \"@fullcalendar/react\";\nimport dayGridPlugin from \"@fullcalendar/daygrid\";\n\nconst CLIENT_ID =\n  \"229181458743-7e5rj587bq9qsjr7e7c5ut4kktgunpgt.apps.googleusercontent.com\";\nconst API_KEY = \"AIzaSyAXTTATGaeYvWKHSiuLd7ucqmHeMxUoX3g\";\n\n// Authorization scopes required by the API; multiple scopes can be\n// included, separated by spaces.\nconst SCOPES =\n  \"https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events https://www.googleapis.com/auth/calendar\";\n\nconst GoogleCalendar = () => {\n  const [events, setEvents] = useState(null);\n\n  useEffect(() => {\n    const script = document.createElement(\"script\");\n    script.async = true;\n    script.defer = true;\n    script.src = \"https://apis.google.com/js/api.js\";\n\n    document.body.appendChild(script);\n\n    script.addEventListener(\"load\", () => {\n      if (window.gapi) handleClientLoad();\n    });\n  }, []);\n\n  const openSignInPopup = () => {\n    window.gapi.auth2.authorize(\n      { client_id: CLIENT_ID, scope: SCOPES },\n      (res) => {\n        console.log(res);\n        if (res) {\n          console.log(window.gapi.client, res);\n\n          if (res.access_token)\n            localStorage.setItem(\"access_token\", res.access_token);\n\n          // fetch(\n          //   `https://www.googleapis.com/calendar/v3/users/me/calendarList?access_token=${res.access_token}`\n          // )\n          //   .then((res) => res.json())\n          //   .then((data) =>\n          //     localStorage.setItem(\"calendarId\", data.items[0].id)\n          //   );\n\n          window.gapi.client.load(\"calendar\", \"v3\", listUpcomingEvents);\n        }\n      }\n    );\n  };\n\n  /**\n   *  On load, called to load the auth2 library and API client library.\n   */\n  const handleClientLoad = () => {\n    window.gapi.load(\"client:auth2\", initClient);\n  };\n\n  /**\n   *  Initializes the API client library and sets up sign-in state\n   *  listeners.\n   */\n  const initClient = () => {\n    if (!localStorage.getItem(\"access_token\")) {\n      openSignInPopup();\n    } else {\n      fetch(\n        `https://www.googleapis.com/calendar/v3/calendars/primary/events?key=${API_KEY}&orderBy=startTime&singleEvents=true`,\n        {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n          },\n        }\n      )\n        .then((res) => {\n          if (res.status !== 401) {\n            return res.json();\n          } else {\n            localStorage.removeItem(\"access_token\");\n\n            openSignInPopup();\n          }\n        })\n        .then((data) => {\n          if (data.items) {\n            console.log(data);\n            setEvents(formatEvents(data.items));\n          }\n        });\n    }\n  };\n\n  /**\n   * Print the summary and start datetime/date of the next ten events in\n   * the authorized user's calendar. If no events are found an\n   * appropriate message is printed.\n   */\n  const listUpcomingEvents = () => {\n    window.gapi.client.calendar.events\n      .list({\n        calendarId: \"primary\",\n        // timeMin: new Date().toISOString(),\n        showDeleted: true,\n        singleEvents: true,\n        // maxResults: 10,\n        // orderBy: \"startTime\",\n      })\n      .then(function (response) {\n        var events = response.result.items;\n\n        console.log(events);\n\n        if (events.length > 0) {\n          setEvents(formatEvents(events));\n        }\n      });\n  };\n\n  const formatEvents = (list) => {\n    return list.map((item) => ({\n      title: item.summary,\n      start: item.start.dateTime || item.start.date,\n      end: item.end.dateTime || item.end.date,\n    }));\n  };\n\n  const addEvent = () => {\n    if (window.gapi.client || localStorage.getItem(\"access_token\")) {\n      let today = new Date();\n\n      fetch(\n        `https://www.googleapis.com/calendar/v3/calendars/primary/events?key=${API_KEY}&timeMax=${new Date(\n          \"Apr 14, 2021\"\n        ).toISOString()}&timeMin=${new Date(\"Apr 15, 2021\").toISOString()}`,\n        {\n          headers: {\n            Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n          },\n        }\n      )\n        .then((res) => res.json())\n        .then((data) => console.log(data));\n      //   fetch(\n      //     `https://www.googleapis.com/calendar/v3/calendars/primary/events?key=${API_KEY}`,\n      //     {\n      //       method: \"POST\",\n      //       headers: {\n      //         Authorization: `Bearer ${localStorage.getItem(\"access_token\")}`,\n      //       },\n      //       body: JSON.stringify({\n      //         end: {\n      //           dateTime: new Date(\"Apr 16, 2021\"),\n      //         },\n      //         start: {\n      //           dateTime: new Date(\"Apr 15, 2021\"),\n      //         },\n      //         summary: \"Test\",\n      //       }),\n      //     }\n      //   );\n    }\n  };\n\n  return (\n    <>\n      <button onClick={addEvent}>Add event</button>\n      <FullCalendar\n        plugins={[dayGridPlugin]}\n        initialView=\"dayGridMonth\"\n        events={events}\n      />\n    </>\n  );\n};\n\nexport default GoogleCalendar;"],"mappings":"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"},"metadata":{},"sourceType":"module"}